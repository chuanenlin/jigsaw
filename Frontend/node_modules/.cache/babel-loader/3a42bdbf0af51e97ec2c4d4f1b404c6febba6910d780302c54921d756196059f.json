{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst validate_1 = require(\"../../compile/validate\");\nconst code_1 = require(\"../code\");\nconst util_1 = require(\"../../compile/util\");\nconst additionalProperties_1 = require(\"./additionalProperties\");\nconst def = {\n  keyword: \"properties\",\n  type: \"object\",\n  schemaType: \"object\",\n  code(cxt) {\n    const {\n      gen,\n      schema,\n      parentSchema,\n      data,\n      it\n    } = cxt;\n    if (it.opts.removeAdditional === \"all\" && parentSchema.additionalProperties === undefined) {\n      additionalProperties_1.default.code(new validate_1.KeywordCxt(it, additionalProperties_1.default, \"additionalProperties\"));\n    }\n    const allProps = (0, code_1.allSchemaProperties)(schema);\n    for (const prop of allProps) {\n      it.definedProperties.add(prop);\n    }\n    if (it.opts.unevaluated && allProps.length && it.props !== true) {\n      it.props = util_1.mergeEvaluated.props(gen, (0, util_1.toHash)(allProps), it.props);\n    }\n    const properties = allProps.filter(p => !(0, util_1.alwaysValidSchema)(it, schema[p]));\n    if (properties.length === 0) return;\n    const valid = gen.name(\"valid\");\n    for (const prop of properties) {\n      if (hasDefault(prop)) {\n        applyPropertySchema(prop);\n      } else {\n        gen.if((0, code_1.propertyInData)(gen, data, prop, it.opts.ownProperties));\n        applyPropertySchema(prop);\n        if (!it.allErrors) gen.else().var(valid, true);\n        gen.endIf();\n      }\n      cxt.it.definedProperties.add(prop);\n      cxt.ok(valid);\n    }\n    function hasDefault(prop) {\n      return it.opts.useDefaults && !it.compositeRule && schema[prop].default !== undefined;\n    }\n    function applyPropertySchema(prop) {\n      cxt.subschema({\n        keyword: \"properties\",\n        schemaProp: prop,\n        dataProp: prop\n      }, valid);\n    }\n  }\n};\nexports.default = def;","map":{"version":3,"names":["validate_1","require","code_1","util_1","additionalProperties_1","def","keyword","type","schemaType","code","cxt","gen","schema","parentSchema","data","it","opts","removeAdditional","additionalProperties","undefined","default","KeywordCxt","allProps","allSchemaProperties","prop","definedProperties","add","unevaluated","length","props","mergeEvaluated","toHash","properties","filter","p","alwaysValidSchema","valid","name","hasDefault","applyPropertySchema","if","propertyInData","ownProperties","allErrors","else","var","endIf","ok","useDefaults","compositeRule","subschema","schemaProp","dataProp","exports"],"sources":["/Users/chuanenl/MyDrive/CMU/Projects/Jigsaw/Code/Frontend/node_modules/ajv/lib/vocabularies/applicator/properties.ts"],"sourcesContent":["import type {CodeKeywordDefinition} from \"../../types\"\nimport {KeywordCxt} from \"../../compile/validate\"\nimport {propertyInData, allSchemaProperties} from \"../code\"\nimport {alwaysValidSchema, toHash, mergeEvaluated} from \"../../compile/util\"\nimport apDef from \"./additionalProperties\"\n\nconst def: CodeKeywordDefinition = {\n  keyword: \"properties\",\n  type: \"object\",\n  schemaType: \"object\",\n  code(cxt: KeywordCxt) {\n    const {gen, schema, parentSchema, data, it} = cxt\n    if (it.opts.removeAdditional === \"all\" && parentSchema.additionalProperties === undefined) {\n      apDef.code(new KeywordCxt(it, apDef, \"additionalProperties\"))\n    }\n    const allProps = allSchemaProperties(schema)\n    for (const prop of allProps) {\n      it.definedProperties.add(prop)\n    }\n    if (it.opts.unevaluated && allProps.length && it.props !== true) {\n      it.props = mergeEvaluated.props(gen, toHash(allProps), it.props)\n    }\n    const properties = allProps.filter((p) => !alwaysValidSchema(it, schema[p]))\n    if (properties.length === 0) return\n    const valid = gen.name(\"valid\")\n\n    for (const prop of properties) {\n      if (hasDefault(prop)) {\n        applyPropertySchema(prop)\n      } else {\n        gen.if(propertyInData(gen, data, prop, it.opts.ownProperties))\n        applyPropertySchema(prop)\n        if (!it.allErrors) gen.else().var(valid, true)\n        gen.endIf()\n      }\n      cxt.it.definedProperties.add(prop)\n      cxt.ok(valid)\n    }\n\n    function hasDefault(prop: string): boolean | undefined {\n      return it.opts.useDefaults && !it.compositeRule && schema[prop].default !== undefined\n    }\n\n    function applyPropertySchema(prop: string): void {\n      cxt.subschema(\n        {\n          keyword: \"properties\",\n          schemaProp: prop,\n          dataProp: prop,\n        },\n        valid\n      )\n    }\n  },\n}\n\nexport default def\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}